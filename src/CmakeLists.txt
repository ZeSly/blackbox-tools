cmake_minimum_required (VERSION 3.12)
project (blackbox_tools VERSION 0.4.4)

set (COMMON_SRC	parser.c tools.c platform.c stream.c decoders.c units.c blackbox_fielddefs.c  ../lib/getopt_mb_uni/getopt.c ../lib/getopt_mb_uni/getopt.h)
set (DECODER_SRC ${COMMON_SRC} blackbox_decode.c gpxwriter.c kmlwriter.c imu.c battery.c stats.c)
set (RENDERER_SRC ${COMMON_SRC} blackbox_render.c datapoints.c embeddedfont.c expo.c imu.c)
set (ENCODER_TESTBED_SRC ${COMMON_SRC} encoder_testbed.c encoder_testbed_io.c)

set (COMMON_HEADER	parser.h tools.h platform.h stream.h decoders.h units.h blackbox_fielddefs.h)
set (DECODER_HEADER ${COMMON_HEADER} gpxwriter.h kmlwriter.h imu.h battery.h stats.h)
set (RENDERER_HEADER ${COMMON_HEADER} datapoints.h embeddedfont.h expo.h imu.h)
set (ENCODER_TESTBED_HEADER ${COMMON_HEADER} encoder_testbed_io.h)

if (WIN32)
    add_compile_definitions(_CRT_SECURE_NO_WARNINGS)
    link_directories(../lib/win32)
endif(WIN32)

add_executable (blackbox_decode ${DECODER_HEADER} ${DECODER_SRC})
target_include_directories(blackbox_decode PRIVATE ../lib/getopt_mb_uni)

add_executable (blackbox_render  ${RENDERER_HEADER} ${RENDERER_SRC})
target_include_directories(blackbox_render PRIVATE ../lib/cairo-1.14/src)
target_include_directories(blackbox_render PRIVATE ../lib/freetype-2.5.3/include)
target_include_directories(blackbox_render PRIVATE ../lib/getopt_mb_uni)
target_link_libraries(blackbox_render cairo libfreetype-6)

# add_executable (encoder_testbed ${ENCODER_TESTBED_HEADER} ${ENCODER_TESTBED_SRC})
# target_include_directories(encoder_testbed PRIVATE ../lib/getopt_mb_uni)
